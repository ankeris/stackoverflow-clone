(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{134:function(e,t,n){e.exports=n(286)},286:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),c=n.n(o),i=n(20),l=n(133),u=n(33),s=n(132),m=n(5),p=n.n(m),d=n(117),f=n.n(d),h=n(119),E=n.n(h),g=n(9),v=n.n(g),b=n(23),y=n.n(b),w=n(45),k=n.n(w),j=n(120),x=n.n(j);var O=p()({root:{flexGrow:1},appbar:{background:"linear-gradient(to right, #464646, #484754, #484963, #454b73, #3e4d83)"},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20}})(function(e){var t=Object(a.useContext)(Pe),n=t.User,o=t.isLoggedIn,c=e.classes;return r.a.createElement("div",{className:c.root},r.a.createElement(f.a,{className:c.appbar,position:"static"},r.a.createElement(E.a,null,r.a.createElement(k.a,{className:c.menuButton,color:"inherit","aria-label":"Menu"},r.a.createElement(x.a,null)),r.a.createElement(v.a,{variant:"h6",color:"inherit",className:c.grow},"Pile Underflow"),o?r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{variant:"h6",color:"inherit",className:c.menuButton},"Logged in as ",n.name),r.a.createElement(y.a,{color:"secondary",variant:"contained",onClick:function(){localStorage.removeItem("token"),window.location.href="/login"}},"Log out")):r.a.createElement(y.a,{color:"primary",variant:"contained"},"Log in"))))}),C=n(44),q=n.n(C),S=n(77),N=n.n(S),B={palette:{primary:{main:"#00bfa5",contrastText:"#ffffff"},secondary:{main:"#e64a19"},error:{main:"#ff0000"}},typography:{useNextVariants:!0}},P=n(30),A=n(124),T=n.n(A),L=n(18),I=n.n(L),U=n(56),W=n.n(U),Q=n(58),_=n.n(Q),F=n(126),J=n.n(F),G=n(57),V=n.n(G),R=n(125),D=n.n(R),H=n(17),Y=n(123),z=n.n(Y),M=function(e){var t=e.placeholder,n=e.field,r=e.type,o=e.multiline;return a.createElement(z.a,Object.assign({type:r,placeholder:t,required:!0},n,{multiline:o,margin:"normal",rows:"5",fullWidth:!0,variant:"outlined"}))},K=p()(function(e){return{paper:{padding:15},palette:{margin:15,justifyContent:"center"}}})(function(e){var t=e.classes,n=e.onSubmit,r=a.useState(!1),o=Object(i.a)(r,2),c=o[0],l=o[1];function u(){l(!1)}return a.createElement(a.Fragment,null,a.createElement(I.a,{container:!0,alignItems:"center",wrap:"nowrap",className:t.palette},a.createElement(v.a,{variant:"h6"},"Add question"),a.createElement(T.a,{color:"primary","aria-label":"Add",onClick:function(){l(!0)}},a.createElement(D.a,null))),a.createElement(W.a,{open:c,onClose:u,fullWidth:!0,maxWidth:"md","aria-labelledby":"form-dialog-title"},a.createElement(V.a,{id:"form-dialog-title"},"Post a question to Pile Underflow!"),a.createElement(_.a,null,a.createElement(J.a,null,a.createElement("br",null),"Please make sure that your question does not exist before asking"),a.createElement(H.c,{initialValues:{title:"",bodyText:""},onSubmit:function(e){n(e)}},function(e){return e.values,a.createElement(H.b,null,a.createElement("div",null,a.createElement(H.a,{name:"title",placeholder:"Question title",component:M})),a.createElement("div",null,a.createElement(H.a,{name:"bodyText",placeholder:"Describe the problem",multiline:!0,component:M})),a.createElement(y.a,{type:"submit",onClick:u,color:"primary",variant:"outlined"},"submit"),a.createElement(y.a,{onClick:u,color:"secondary"},"Cancel"))}))))}),X=function(){return new Headers({Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"})},Z={registerUser:function(e){var t=e.username,n=e.password;return new Promise(function(e,a){fetch("".concat("https://pileunderflow.herokuapp.com/api","/users/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,password:n})}).then(function(t){e({status:t.status,message:t.json()})})})},login:function(e){var t=e.username,n=e.password;return new Promise(function(e,a){fetch("".concat("https://pileunderflow.herokuapp.com/api","/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,password:n})}).then(function(t){500!==t.status?e(t.json()):a("bad rq")})})}},$={getAll:function(){return new Promise(function(e,t){fetch("".concat("https://pileunderflow.herokuapp.com/api","/questions"),{headers:X()}).then(function(t){var n=t.json();e(n)}).catch(function(e){return t(e)})})},getOne:function(e){return new Promise(function(t,n){fetch("".concat("https://pileunderflow.herokuapp.com/api","/questions/").concat(e),{headers:X()}).then(function(e){var n=e.json();t(n)}).catch(function(e){return n(e)})})},postQuestion:function(e){var t=e.title,n=e.bodyText,a=e.userId;return new Promise(function(e,r){fetch("".concat("https://pileunderflow.herokuapp.com/api","/questions/user/").concat(a),{method:"POST",headers:X(),body:JSON.stringify({title:t,body:n,createdBy:a})}).then(function(t){return e(t.json())})})},upvoteQuestion:function(e,t){return new Promise(function(n,a){fetch("".concat("https://pileunderflow.herokuapp.com/api","/questions/upvote/").concat(e,"/user/").concat(t),{method:"PATCH",headers:X()}).then(function(e){return n(e.json())})})}},ee=n(22),te=n.n(ee),ne=n(32),ae=n.n(ne),re=n(127),oe=n.n(re),ce=p()(function(e){return{root:{flexGrow:1,overflow:"hidden",padding:"0 ".concat(3*e.spacing.unit,"px")},btn:{width:"100%",marginBottom:"".concat(2*e.spacing.unit,"px"),maxWidth:"800px"},paper:{padding:2*e.spacing.unit},avatar:{backgroundColor:e.palette.primary.light}}})(function(e){var t=e.handleClick,n=e.id,a=e.classes,o=e.title,c=e.upvotesCount,i=e.createdAt,l=e.createdBy;return r.a.createElement(oe.a,{className:a.btn,onClick:function(){return t(n)}},r.a.createElement(te.a,{className:a.paper},r.a.createElement(I.a,{container:!0,wrap:"nowrap",spacing:16},r.a.createElement(I.a,{item:!0},r.a.createElement(ae.a,{color:"primary",className:c>0?a.avatar:null},c)),r.a.createElement(I.a,{item:!0,xs:!0},r.a.createElement(v.a,{variant:"h6",component:"h3"},o)),r.a.createElement(I.a,{item:!0},r.a.createElement(v.a,{align:"right",variant:"overline",gutterBottom:!0},l.name),r.a.createElement(v.a,{align:"right",variant:"overline",gutterBottom:!0},i)))))}),ie=function(){return r.a.createElement("div",{className:"lds-ripple"},r.a.createElement("div",null),r.a.createElement("div",null))};function le(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),o=n[0],c=n[1],l=Object(a.useContext)(Pe).User;return Object(a.useEffect)(function(){$.getAll().then(function(e){return c(e)})},[]),r.a.createElement("div",{className:"content-center content-section"},r.a.createElement(K,{onSubmit:function(t){return n=t,void $.postQuestion(Object(P.a)({},n,{userId:l._id})).then(function(t){e.history.push("/questions/"+t._id)});var n}}),o.length?o.map(function(t){return r.a.createElement(ce,{handleClick:function(t){return e.history.push("/questions/"+t)},key:t._id,id:t._id,title:t.title,upvotesCount:t.upvotesCount,createdAt:t.createdAt,createdBy:t.createdBy})}):r.a.createElement(ie,null))}var ue={getAllForQuestion:function(e){return new Promise(function(t,n){fetch("".concat("https://pileunderflow.herokuapp.com/api","/questions/").concat(e,"/comments"),{headers:X()}).then(function(e){var n=e.json();t(n)}).catch(function(e){return n(e)})})},postComment:function(e,t,n){return new Promise(function(a,r){fetch("".concat("https://pileunderflow.herokuapp.com/api","//questions/").concat(e,"/user/").concat(t),{method:"POST",headers:X(),body:JSON.stringify({body:n})}).then(function(e){return a(e.json())})})}},se=n(129),me=n.n(se),pe=n(130),de=n.n(pe),fe=n(128),he=n.n(fe),Ee=p()(function(e){return{wrapper:{marginBottom:"".concat(2*e.spacing.unit,"px"),width:"100%",maxWidth:"800px"},paper:{padding:2*e.spacing.unit},avatar:{backgroundColor:e.palette.primary.light},button:{"&:disabled":{color:e.palette.primary.light}}}})(function(e){var t=e.classes,n=e.question,a=e.liked,o=e.like,c=e.dislike;return r.a.createElement("section",{className:t.wrapper+" push-top"},r.a.createElement(te.a,{className:t.paper},r.a.createElement(I.a,{container:!0,spacing:16},r.a.createElement(I.a,{container:!0,alignItems:"center",wrap:"nowrap"},r.a.createElement(I.a,{style:{textAlign:"center",margin:"0 10px"}},r.a.createElement(he.a,{title:a?"You've already liked this question":"Like"},r.a.createElement("span",null,r.a.createElement(k.a,{disabled:a,color:a?"primary":"default",className:t.button,onClick:o},r.a.createElement(me.a,null)))),r.a.createElement(ae.a,{color:"primary",className:n.upvotesCount>0?t.avatar:null},n.upvotesCount),r.a.createElement(k.a,{onClick:c},r.a.createElement(de.a,null))),r.a.createElement(v.a,{variant:"h6",component:"h3"},n.title)),r.a.createElement(I.a,{item:!0,xs:12},r.a.createElement(v.a,null,n.body))),r.a.createElement(I.a,{container:!0,direction:"column",justify:"flex-end",alignItems:"flex-end"},r.a.createElement(ae.a,{src:n.createdBy.image,color:"primary"}),r.a.createElement(v.a,{align:"right",variant:"overline",gutterBottom:!0},n.createdBy.name," ",r.a.createElement("br",null),n.createdAt))))}),ge=n(76),ve=Object(ge.withStyles)(function(e){return{root:{flexGrow:1,overflow:"hidden",padding:"0 ".concat(3*e.spacing.unit,"px")},wrapper:{marginBottom:"".concat(2*e.spacing.unit,"px"),width:"100%",maxWidth:"800px"},paper:{padding:2*e.spacing.unit},avatar:{marginLeft:"auto"}}})(function(e){var t=e.classes,n=e.body,a=(e.upvotesCount,e.createdAt),o=e.createdBy;return r.a.createElement("section",{className:t.wrapper},r.a.createElement(te.a,{className:t.paper},r.a.createElement(I.a,{container:!0,wrap:"nowrap",spacing:16},r.a.createElement(I.a,{item:!0,xs:!0},r.a.createElement(v.a,null,n)),r.a.createElement(I.a,{item:!0},r.a.createElement(ae.a,{className:t.avatar,src:o.image,color:"primary"}),r.a.createElement(v.a,{align:"right",variant:"overline",gutterBottom:!0},o.name),r.a.createElement(v.a,{align:"right",variant:"overline",gutterBottom:!0},a)))))}),be=p()(function(e){return{paper:{padding:2*e.spacing.unit,maxWidth:"600px",width:"100%"}}})(function(e){var t=e.classes,n=e.onSubmit;return a.createElement(te.a,{color:"primary",className:t.paper},a.createElement(H.c,{initialValues:{bodyText:""},onSubmit:function(e){n(e)}},function(e){return e.values,a.createElement(H.b,null,a.createElement("div",null,a.createElement(H.a,{name:"bodyText",placeholder:"Post your answer here",multiline:!0,component:M})),a.createElement(y.a,{type:"submit",color:"primary",variant:"outlined"},"submit"))}))}),ye=n(75),we=n.n(ye),ke=function(e){var t=e.history;return a.createElement(we.a,{onClick:function(){return t.goBack()},color:"default",variant:"contained"},"Go back \ud83d\udeaa")};function je(e,t){switch(t.type){case"getQuestion":return Object(P.a)({},e,{question:t.question});case"getComments":return Object(P.a)({},e,{comments:t.comments});case"like":var n=e.question;return $.upvoteQuestion(n._id,t.user._id),n.upvotesCount+=1,Object(P.a)({},e,{question:n,isLiked:!0});case"isLiked":return Object(P.a)({},e,{isLiked:t.value});case"dislike":var a=e.question;return a.upvotesCount-=1,Object(P.a)({},e,{question:a});default:throw new Error}}var xe={question:{},comments:[]},Oe=function(e){var t=e.history,n=e.match,o=Object(a.useReducer)(je,xe),c=Object(i.a)(o,2),l=c[0],u=c[1],s=Object(a.useContext)(Pe).User;return Object(a.useEffect)(function(){$.getOne(n.params.id).then(function(e){-1!==e.upvotes.indexOf(s._id)&&u({type:"isLiked",value:!0,user:s}),u({type:"getQuestion",question:e})}),ue.getAllForQuestion(n.params.id).then(function(e){u({type:"getComments",comments:e})})},[]),r.a.createElement("div",{className:"content-center content-section"},r.a.createElement(ke,{history:t}),l.question._id?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee,{liked:l.isLiked,question:l.question,like:function(){return u({type:"like",user:s})},dislike:function(){return u({type:"dislike"})}}),r.a.createElement(v.a,{variant:"h5",gutterBottom:!0},"Answers:")):r.a.createElement(ie,null),l.comments?l.comments.map(function(e){return r.a.createElement(ve,{key:e._id,body:e.body,upvotesCount:e.upvotesCount,createdBy:e.createdBy,createdAt:e.createdAt})}):null,r.a.createElement(be,{onSubmit:function(e){return t=e.bodyText,void ue.postComment(n.params.id,s._id,t).then(function(e){return ue.getAllForQuestion(n.params.id).then(function(e){u({type:"getComments",comments:e})})});var t}}))},Ce=p()(function(e){return{paper:{padding:2*e.spacing.unit,maxWidth:"600px",width:"100%"}}})(function(e){var t=e.history,n=e.classes,o=e.setAuth,c=Object(a.useState)(!1),l=Object(i.a)(c,2),u=l[0],s=l[1],m=Object(a.useState)(""),p=Object(i.a)(m,2),d=p[0],f=p[1],h=Object(a.useState)(""),E=Object(i.a)(h,2),g=E[0],b=E[1],w=Object(a.useState)(""),k=Object(i.a)(w,2),j=k[0],x=k[1];function O(){s(!1),x("")}return r.a.createElement("div",{className:"content-center content-section"},r.a.createElement(te.a,{color:"primary",className:n.paper},r.a.createElement(v.a,{variant:"h5",component:"h4"},"Login to PileUnderflow! \ud83d\ude4b\u200d"),d?r.a.createElement(v.a,{color:"primary"},d):"",g?r.a.createElement(v.a,{color:"secondary"},g):"",r.a.createElement(H.c,{initialValues:{username:"",password:""},onSubmit:function(e){!function(e){Z.login(e).then(function(e){b("");var n=e;localStorage.setItem("token",n),o(),t.push("/questions/")},function(e){b("Username or password incorrect!")})}(e)}},function(e){return e.values,r.a.createElement(H.b,null,r.a.createElement(H.a,{name:"username",type:"text",placeholder:"Username",component:M}),r.a.createElement(H.a,{name:"password",type:"password",placeholder:"Password",component:M}),r.a.createElement(y.a,{type:"submit",color:"primary",variant:"outlined"},"Login"))})),r.a.createElement("div",{className:"push-top"},r.a.createElement(y.a,{onClick:function(){s(!0)},type:"button",color:"secondary",variant:"contained"},"Don't have an account yet?"),r.a.createElement(W.a,{open:u,onClose:O,fullWidth:!0,maxWidth:"sm","aria-labelledby":"form-dialog-title"},r.a.createElement(V.a,{id:"form-dialog-title"},"Register form. Welcome! \ud83c\udf89"),r.a.createElement(_.a,null,r.a.createElement(H.c,{initialValues:{username:"",password:""},onSubmit:function(e){!function(e){Z.registerUser(e).then(function(e){500!==e.status?(e.message.then(function(e){return f("You have successfully created an account. Log in now \ud83d\ude0e")}),s(!1)):e.message.then(function(e){return x(e)})})}(e)}},function(e){return e.values,r.a.createElement(H.b,null,j?r.a.createElement(v.a,{color:"error"},j):"",r.a.createElement(H.a,{name:"username",type:"text",placeholder:"Type username",component:M}),r.a.createElement(H.a,{name:"password",type:"password",placeholder:"Type new password",component:M}),r.a.createElement(y.a,{type:"submit",color:"primary",variant:"outlined"},"Register"),r.a.createElement(y.a,{onClick:O,color:"secondary"},"Cancel"))})))))}),qe=n(131),Se=n.n(qe);function Ne(e){var t=e.component,n=e.authed,a=Object(l.a)(e,["component","authed"]);return r.a.createElement(u.b,Object.assign({},a,{render:function(e){return n?r.a.createElement(t,e):r.a.createElement(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var Be=function(){var e=localStorage.getItem("token");if(!e)return!1;try{return Se()(e)}catch(t){return!1}return!0},Pe=Object(a.createContext)({}),Ae=function(){var e=Object(a.useState)(Be().user||{}),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!!Be().user),l=Object(i.a)(c,2),m=l[0],p=l[1];return r.a.createElement(N.a,{theme:q()(B)},r.a.createElement(Pe.Provider,{value:{User:n,isLoggedIn:m}},r.a.createElement(s.a,null,r.a.createElement(O,null),r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/login",render:function(e){return r.a.createElement(Ce,Object.assign({},e,{setAuth:function(){return o(Be().user),void p(!!Be().user)}}))}}),r.a.createElement(Ne,{authed:Be,path:"/questions/:id",component:Oe}),r.a.createElement(Ne,{authed:Be,path:"/questions",component:le}),m?r.a.createElement(u.a,{from:"/",to:"/questions"}):r.a.createElement(u.a,{from:"/",to:"/login"})))))};c.a.render(r.a.createElement(Ae,null),document.getElementById("root"))}},[[134,1,2]]]);
//# sourceMappingURL=main.b81d7728.chunk.js.map